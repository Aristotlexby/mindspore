npy是：
num_layer,profile_cost: 30 {'1': array([6.75600e-05, 6.76020e-05, 7.05840e-05, 7.04580e-05, 6.88860e-05,
       6.90000e-05, 7.30680e-05, 7.14840e-05, 6.90300e-05, 6.82740e-05,
       7.03320e-05, 7.80060e-05, 6.88440e-05, 6.90180e-05, 6.89640e-05,
       7.28400e-05, 7.25100e-05, 6.90480e-05, 6.79860e-05, 6.98820e-05,
       7.47840e-05, 7.02120e-05, 6.78120e-05, 6.82620e-05, 7.35120e-05,
       7.04580e-05, 6.92760e-05, 6.80280e-05, 6.81360e-05, 3.86376e-04]), '2': array([0.0001448 , 0.00014163, 0.00013943, 0.00013897, 0.00013841,
       0.000138  , 0.00013861, 0.0001382 , 0.00013768, 0.00013968,
       0.00013937, 0.00013978, 0.00013968, 0.00013843, 0.0001392 ,
       0.00013787, 0.0001381 , 0.00013767, 0.00013899, 0.00013931,
       0.00013924, 0.00013869, 0.00013949, 0.00013938, 0.00013925,
       0.00013898, 0.00013732, 0.00013849, 0.00013904, 0.00083459]), '4': array([2.2408500e-05, 2.2696500e-05, 2.3900550e-05, 2.3111175e-05,
       2.2517925e-05, 2.2441500e-05, 2.2826475e-05, 2.3000325e-05,
       2.2440000e-05, 2.3088675e-05, 2.2736625e-05, 2.2458000e-05,
       2.2435500e-05, 2.2962900e-05, 2.2571925e-05, 2.2649775e-05,
       2.2510425e-05, 2.2637775e-05, 2.2446075e-05, 2.2883475e-05,
       2.2655775e-05, 2.2450500e-05, 2.2798050e-05, 2.3118675e-05,
       2.2561425e-05, 2.2441500e-05, 2.2950900e-05, 2.2482000e-05,
       2.2613775e-05, 1.7505090e-04]), '8': array([2.982000e-05, 2.997450e-05, 3.090750e-05, 3.036150e-05,
       2.987550e-05, 3.030300e-05, 3.035550e-05, 2.991000e-05,
       3.027150e-05, 3.045300e-05, 3.013050e-05, 3.028650e-05,
       2.983800e-05, 3.023100e-05, 3.029700e-05, 3.040650e-05,
       2.982600e-05, 3.022200e-05, 2.988300e-05, 3.042750e-05,
       3.057150e-05, 3.018150e-05, 2.996850e-05, 3.004200e-05,
       2.984550e-05, 3.069750e-05, 3.061800e-05, 2.992800e-05,
       3.016950e-05, 2.170995e-04])}

得到的策略是
{'hidden_size': Tensor(shape=[1], dtype=Float32, value= [ 1.02400000e+03]), 'sequence_length': Tensor(shape=[1], dtype=Float32, value= [ 1.02400000e+03]), 'num_layers': Tensor(shape=[1], dtype=Float32, value= [ 3.00000000e+01]), 'vocab_size': Tensor(shape=[1], dtype=Float32, value= [ 5.22560000e+04]), 'type': 'gpt2'}
gbs:32
rank 0: ((1, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 18, 30]), Tensor(shape=[1], dtype=Float64, value= [ 1.46629811e-02]))
rank 1: ((2, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 18, 30]), Tensor(shape=[1], dtype=Float64, value= [ 1.57434643e-02]))
rank 2: ((4, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 18, 30]), Tensor(shape=[1], dtype=Float64, value= [ 1.79044308e-02]))
rank 3: ((8, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 18, 30]), Tensor(shape=[1], dtype=Float64, value= [ 2.22263637e-02]))
rank 4: ((1, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 8.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 4, 12, 14, 17, 18, 23, 25, 30]), Tensor(shape=[1], dtype=Float64, value= [ 2.76483468e-02]))
rank 5: ((2, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 8.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 7, 13, 15, 16, 17, 22, 28, 30]), Tensor(shape=[1], dtype=Float64, value= [ 2.88504443e-02]))
rank 6: ((16, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 18, 30]), Tensor(shape=[1], dtype=Float64, value= [ 3.08702296e-02]))
rank 7: ((1, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 8.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 3.49728480e-02]))
rank 8: ((2, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 8.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 3.49728480e-02]))
rank 9: ((4, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 8.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 3.49728480e-02]))
rank 10: ((8, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 8.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 3.49728480e-02]))
rank 11: ((16, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 8.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 3.49728480e-02]))
rank 12: ((32, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 8.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 3.49728480e-02]))
rank 13: ((4, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 8.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 9, 12, 14, 15, 16, 20, 25, 30]), Tensor(shape=[1], dtype=Float64, value= [ 4.70150833e-02]))
rank 14: ((32, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 15, 30]), Tensor(shape=[1], dtype=Float64, value= [ 4.81579596e-02]))
rank 15: ((1, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 8, 18, 25, 30]), Tensor(shape=[1], dtype=Float64, value= [ 4.99223006e-02]))
rank 16: ((2, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 9, 16, 25, 30]), Tensor(shape=[1], dtype=Float64, value= [ 5.54154182e-02]))
rank 17: ((4, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 8, 18, 28, 30]), Tensor(shape=[1], dtype=Float64, value= [ 6.64217291e-02]))
rank 18: ((8, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 8.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 9, 12, 13, 14, 16, 23, 26, 30]), Tensor(shape=[1], dtype=Float64, value= [ 7.20069507e-02]))
rank 19: ((1, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 7.37395405e-02]))
rank 20: ((2, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 7.37395405e-02]))
rank 21: ((4, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 7.37395405e-02]))
rank 22: ((8, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 7.37395405e-02]))
rank 23: ((16, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 7.37395405e-02]))
rank 24: ((8, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 9, 18, 26, 30]), Tensor(shape=[1], dtype=Float64, value= [ 8.51898166e-02]))
rank 25: ((1, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 10, 18, 25, 30]), Tensor(shape=[1], dtype=Float64, value= [ 9.54033242e-02]))
rank 26: ((4, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 9, 18, 27, 30]), Tensor(shape=[1], dtype=Float64, value= [ 9.78655958e-02]))
rank 27: ((2, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 10, 16, 25, 30]), Tensor(shape=[1], dtype=Float64, value= [ 9.91408756e-02]))
rank 28: ((1, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 17, 30]), Tensor(shape=[1], dtype=Float64, value= [ 1.11496808e-01]))
rank 29: ((8, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 8, 16, 25, 30]), Tensor(shape=[1], dtype=Float64, value= [ 1.13243748e-01]))
rank 30: ((2, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 17, 30]), Tensor(shape=[1], dtype=Float64, value= [ 1.14535734e-01]))
rank 31: ((4, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 17, 30]), Tensor(shape=[1], dtype=Float64, value= [ 1.20613583e-01]))
rank 32: ((16, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 8.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 5, 12, 14, 15, 16, 21, 27, 30]), Tensor(shape=[1], dtype=Float64, value= [ 1.22246285e-01]))
rank 33: ((16, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 9, 16, 25, 30]), Tensor(shape=[1], dtype=Float64, value= [ 1.32319065e-01]))
rank 34: ((8, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 17, 30]), Tensor(shape=[1], dtype=Float64, value= [ 1.32769280e-01]))
rank 35: ((16, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 8, 16, 23, 30]), Tensor(shape=[1], dtype=Float64, value= [ 1.35360473e-01]))
rank 36: ((16, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 15, 30]), Tensor(shape=[1], dtype=Float64, value= [ 1.49027613e-01]))
rank 37: ((8, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 15, 30]), Tensor(shape=[1], dtype=Float64, value= [ 2.05924498e-01]))
rank 38: ((1, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 17, 30]), Tensor(shape=[1], dtype=Float64, value= [ 2.17010835e-01]))
rank 39: ((2, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 17, 30]), Tensor(shape=[1], dtype=Float64, value= [ 2.18878384e-01]))
rank 40: ((1, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 2.20140041e-01]))
rank 41: ((2, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 2.20140041e-01]))
rank 42: ((4, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 2.20140041e-01]))
rank 43: ((8, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 2.20140041e-01]))
rank 44: ((32, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 8, 16, 23, 30]), Tensor(shape=[1], dtype=Float64, value= [ 2.20208939e-01]))
rank 45: ((4, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 4.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 2.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 17, 30]), Tensor(shape=[1], dtype=Float64, value= [ 2.22613481e-01]))
rank 46: ((32, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 8.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 4, 8, 12, 16, 20, 24, 27, 30]), Tensor(shape=[1], dtype=Float64, value= [ 2.27771277e-01]))
rank 47: ((1, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 8.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 4.32466776e-01]))
rank 48: ((2, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 8.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 4.32466776e-01]))
rank 49: ((4, {'mp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00]), 'dp_deg': Tensor(shape=[1], dtype=Float32, value= [ 8.00000000e+00]), 'pp_deg': Tensor(shape=[1], dtype=Float32, value= [ 1.00000000e+00])}, defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7]}), [0, 30]), Tensor(shape=[1], dtype=Float64, value= [ 4.32466776e-01]))


吞吐量测试
MP=1 DP=4 PP=2
均分：
2024-04-02 18:47:52,070 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 18:47:52,097 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    2/   20], loss: 0.000, per_step_time: 151946ms, lr: 1e-04, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 18:47:52,121 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   10.0% |█████                                             | 0.01 samples/s/p  0:45:35 }
2024-04-02 18:47:53,345 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 18:47:53,357 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    4/   20], loss: 0.000, per_step_time: 597ms, lr: 9.0999994e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 18:47:53,373 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   20.0% |██████████                                        | 3.35 samples/s/p  0:00:09 }
2024-04-02 18:47:54,530 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 18:47:54,538 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    6/   20], loss: 0.000, per_step_time: 568ms, lr: 8.2e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 18:47:54,544 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   30.0% |███████████████                                   | 3.52 samples/s/p  0:00:07 }
2024-04-02 18:47:55,724 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 18:47:55,734 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    8/   20], loss: 0.000, per_step_time: 580ms, lr: 7.3e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 18:47:55,739 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   40.0% |████████████████████                              | 3.44 samples/s/p  0:00:06 }
2024-04-02 18:47:56,903 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 18:47:56,904 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   10/   20], loss: 0.000, per_step_time: 568ms, lr: 6.4e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 18:47:56,904 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   50.0% |█████████████████████████                         | 3.52 samples/s/p  0:00:05 }
2024-04-02 18:47:57,997 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 18:47:57,998 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   12/   20], loss: 0.000, per_step_time: 543ms, lr: 5.4999993e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 18:47:57,998 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   60.0% |██████████████████████████████                    | 3.68 samples/s/p  0:00:04 }
2024-04-02 18:47:59,073 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 18:47:59,074 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   14/   20], loss: 0.000, per_step_time: 534ms, lr: 4.5999997e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 18:47:59,074 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   70.0% |███████████████████████████████████               | 3.74 samples/s/p  0:00:03 }
2024-04-02 18:48:00,150 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 18:48:00,151 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   16/   20], loss: 0.000, per_step_time: 534ms, lr: 3.6999998e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 18:48:00,151 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   80.0% |████████████████████████████████████████          | 3.74 samples/s/p  0:00:02 }
2024-04-02 18:48:01,228 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 18:48:01,229 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   18/   20], loss: 0.000, per_step_time: 535ms, lr: 2.7999997e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 18:48:01,229 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   90.0% |█████████████████████████████████████████████     | 3.74 samples/s/p  0:00:01 }
2024-04-02 18:48:02,311 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 18:48:02,312 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   20/   20], loss: 0.000, per_step_time: 537ms, lr: 1.8999996e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 18:48:02,312 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   100.0% |██████████████████████████████████████████████████| 3.72 samples/s/p  0:00:00 }
2024-04-02 18:48:02,316 - mindformers[mindformers/trainer/base_trainer.py:735] - INFO - .........Training Over!.............

使用[0,18,30]进行吞吐量测试
2024-04-02 19:18:43,756 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:18:43,767 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    2/   20], loss: 0.000, per_step_time: 164501ms, lr: 1e-04, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:18:43,775 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   10.0% |█████                                             | 0.01 samples/s/p  0:49:21 }
2024-04-02 19:18:44,722 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:18:44,734 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    4/   20], loss: 0.000, per_step_time: 459ms, lr: 9.0999994e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:18:44,744 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   20.0% |██████████                                        | 4.35 samples/s/p  0:00:07 }
2024-04-02 19:18:45,582 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:18:45,589 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    6/   20], loss: 0.000, per_step_time: 410ms, lr: 8.2e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:18:45,595 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   30.0% |███████████████                                   | 4.87 samples/s/p  0:00:05 }
2024-04-02 19:18:46,411 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:18:46,413 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    8/   20], loss: 0.000, per_step_time: 400ms, lr: 7.3e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:18:46,415 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   40.0% |████████████████████                              | 5.00 samples/s/p  0:00:04 }
2024-04-02 19:18:47,226 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:18:47,231 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   10/   20], loss: 0.000, per_step_time: 400ms, lr: 6.4e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:18:47,236 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   50.0% |█████████████████████████                         | 5.00 samples/s/p  0:00:04 }
2024-04-02 19:18:48,049 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:18:48,051 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   12/   20], loss: 0.000, per_step_time: 402ms, lr: 5.4999993e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:18:48,055 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   60.0% |██████████████████████████████                    | 4.97 samples/s/p  0:00:03 }
2024-04-02 19:18:48,825 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:18:48,833 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   14/   20], loss: 0.000, per_step_time: 374ms, lr: 4.5999997e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:18:48,837 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   70.0% |███████████████████████████████████               | 5.34 samples/s/p  0:00:02 }
2024-04-02 19:18:49,618 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:18:49,624 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   16/   20], loss: 0.000, per_step_time: 385ms, lr: 3.6999998e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:18:49,628 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   80.0% |████████████████████████████████████████          | 5.19 samples/s/p  0:00:01 }
2024-04-02 19:18:50,487 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:18:50,488 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   18/   20], loss: 0.000, per_step_time: 420ms, lr: 2.7999997e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:18:50,488 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   90.0% |█████████████████████████████████████████████     | 4.75 samples/s/p  0:00:00 }
2024-04-02 19:18:51,212 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:18:51,213 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   20/   20], loss: 0.000, per_step_time: 358ms, lr: 1.8999996e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:18:51,213 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   100.0% |██████████████████████████████████████████████████| 5.57 samples/s/p  0:00:00 }
2024-04-02 19:18:51,217 - mindformers[mindformers/trainer/base_trainer.py:735] - INFO - .........Training Over!.............

MP=2 DP=2 PP=2
均分：
2024-04-02 19:39:45,170 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:39:45,179 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    2/   20], loss: 0.000, per_step_time: 131728ms, lr: 1e-04, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:39:45,187 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   10.0% |█████                                             | 0.02 samples/s/p  0:39:31 }
2024-04-02 19:39:46,065 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:39:46,072 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    4/   20], loss: 0.000, per_step_time: 431ms, lr: 9.0999994e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:39:46,075 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   20.0% |██████████                                        | 4.63 samples/s/p  0:00:06 }
2024-04-02 19:39:46,940 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:39:46,946 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    6/   20], loss: 0.000, per_step_time: 425ms, lr: 8.2e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:39:46,951 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   30.0% |███████████████                                   | 4.70 samples/s/p  0:00:05 }
2024-04-02 19:39:47,783 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:39:47,786 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    8/   20], loss: 0.000, per_step_time: 408ms, lr: 7.3e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:39:47,802 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   40.0% |████████████████████                              | 4.90 samples/s/p  0:00:04 }
2024-04-02 19:39:48,610 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:39:48,619 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   10/   20], loss: 0.000, per_step_time: 396ms, lr: 6.4e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:39:48,621 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   50.0% |█████████████████████████                         | 5.05 samples/s/p  0:00:03 }
2024-04-02 19:39:49,434 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:39:49,439 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   12/   20], loss: 0.000, per_step_time: 400ms, lr: 5.4999993e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:39:49,441 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   60.0% |██████████████████████████████                    | 4.99 samples/s/p  0:00:03 }
2024-04-02 19:39:50,276 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:39:50,279 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   14/   20], loss: 0.000, per_step_time: 407ms, lr: 4.5999997e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:39:50,281 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   70.0% |███████████████████████████████████               | 4.90 samples/s/p  0:00:02 }
2024-04-02 19:39:51,126 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:39:51,126 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   16/   20], loss: 0.000, per_step_time: 412ms, lr: 3.6999998e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:39:51,127 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   80.0% |████████████████████████████████████████          | 4.85 samples/s/p  0:00:01 }
2024-04-02 19:39:51,903 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:39:51,903 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   18/   20], loss: 0.000, per_step_time: 384ms, lr: 2.7999997e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:39:51,903 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   90.0% |█████████████████████████████████████████████     | 5.20 samples/s/p  0:00:00 }
2024-04-02 19:39:52,670 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:39:52,671 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   20/   20], loss: 0.000, per_step_time: 380ms, lr: 1.8999996e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:39:52,671 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   100.0% |██████████████████████████████████████████████████| 5.26 samples/s/p  0:00:00 }
2024-04-02 19:39:52,674 - mindformers[mindformers/trainer/base_trainer.py:735] - INFO - .........Training Over!.............

使用[0,18,30]进行吞吐量测试：
2024-04-02 19:26:54,622 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:26:54,658 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    2/   20], loss: 0.000, per_step_time: 151740ms, lr: 1e-04, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:26:54,698 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   10.0% |█████                                             | 0.01 samples/s/p  0:45:31 }
2024-04-02 19:26:55,939 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:26:55,968 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    4/   20], loss: 0.000, per_step_time: 602ms, lr: 9.0999994e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:26:55,998 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   20.0% |██████████                                        | 3.32 samples/s/p  0:00:09 }
2024-04-02 19:26:57,002 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:26:57,023 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    6/   20], loss: 0.000, per_step_time: 485ms, lr: 8.2e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:26:57,027 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   30.0% |███████████████                                   | 4.12 samples/s/p  0:00:06 }
2024-04-02 19:26:57,965 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:26:57,975 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    8/   20], loss: 0.000, per_step_time: 458ms, lr: 7.3e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:26:57,988 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   40.0% |████████████████████                              | 4.36 samples/s/p  0:00:05 }
2024-04-02 19:26:58,874 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:26:58,881 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   10/   20], loss: 0.000, per_step_time: 431ms, lr: 6.4e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:26:58,889 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   50.0% |█████████████████████████                         | 4.64 samples/s/p  0:00:04 }
2024-04-02 19:26:59,854 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:26:59,865 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   12/   20], loss: 0.000, per_step_time: 475ms, lr: 5.4999993e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:26:59,877 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   60.0% |██████████████████████████████                    | 4.21 samples/s/p  0:00:03 }
2024-04-02 19:27:01,328 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:27:01,350 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   14/   20], loss: 0.000, per_step_time: 712ms, lr: 4.5999997e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:27:01,352 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   70.0% |███████████████████████████████████               | 2.81 samples/s/p  0:00:04 }
2024-04-02 19:27:02,201 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:27:02,209 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   16/   20], loss: 0.000, per_step_time: 406ms, lr: 3.6999998e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:27:02,223 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   80.0% |████████████████████████████████████████          | 4.92 samples/s/p  0:00:01 }
2024-04-02 19:27:03,029 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:27:03,030 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   18/   20], loss: 0.000, per_step_time: 373ms, lr: 2.7999997e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:27:03,030 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   90.0% |█████████████████████████████████████████████     | 5.36 samples/s/p  0:00:00 }
2024-04-02 19:27:03,788 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:27:03,789 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   20/   20], loss: 0.000, per_step_time: 376ms, lr: 1.8999996e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:27:03,789 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   100.0% |██████████████████████████████████████████████████| 5.32 samples/s/p  0:00:00 }
2024-04-02 19:27:03,795 - mindformers[mindformers/trainer/base_trainer.py:735] - INFO - .........Training Over!.............

MP=4 DP=1 PP=2
均分：
2024-04-02 19:45:54,639 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:45:54,706 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    2/   20], loss: 0.000, per_step_time: 128805ms, lr: 1e-04, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:45:54,759 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   10.0% |█████                                             | 0.02 samples/s/p  0:38:38 }
2024-04-02 19:45:55,837 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:45:55,888 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    4/   20], loss: 0.000, per_step_time: 482ms, lr: 9.0999994e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:45:55,928 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   20.0% |██████████                                        | 4.15 samples/s/p  0:00:07 }
2024-04-02 19:45:56,670 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:45:56,688 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    6/   20], loss: 0.000, per_step_time: 345ms, lr: 8.2e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:45:56,693 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   30.0% |███████████████                                   | 5.80 samples/s/p  0:00:04 }
2024-04-02 19:45:57,458 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:45:57,486 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    8/   20], loss: 0.000, per_step_time: 361ms, lr: 7.3e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:45:57,524 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   40.0% |████████████████████                              | 5.53 samples/s/p  0:00:04 }
2024-04-02 19:45:58,170 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:45:58,173 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   10/   20], loss: 0.000, per_step_time: 310ms, lr: 6.4e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:45:58,181 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   50.0% |█████████████████████████                         | 6.45 samples/s/p  0:00:03 }
2024-04-02 19:45:58,825 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:45:58,829 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   12/   20], loss: 0.000, per_step_time: 314ms, lr: 5.4999993e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:45:58,834 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   60.0% |██████████████████████████████                    | 6.36 samples/s/p  0:00:02 }
2024-04-02 19:45:59,462 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:45:59,463 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   14/   20], loss: 0.000, per_step_time: 302ms, lr: 4.5999997e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:45:59,463 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   70.0% |███████████████████████████████████               | 6.61 samples/s/p  0:00:01 }
2024-04-02 19:46:00,014 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:46:00,014 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   16/   20], loss: 0.000, per_step_time: 267ms, lr: 3.6999998e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:46:00,015 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   80.0% |████████████████████████████████████████          | 7.49 samples/s/p  0:00:01 }
2024-04-02 19:46:00,559 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:46:00,560 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   18/   20], loss: 0.000, per_step_time: 269ms, lr: 2.7999997e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:46:00,560 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   90.0% |█████████████████████████████████████████████     | 7.43 samples/s/p  0:00:00 }
2024-04-02 19:46:01,105 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:46:01,106 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   20/   20], loss: 0.000, per_step_time: 268ms, lr: 1.8999996e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:46:01,106 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   100.0% |██████████████████████████████████████████████████| 7.44 samples/s/p  0:00:00 }
2024-04-02 19:46:01,111 - mindformers[mindformers/trainer/base_trainer.py:735] - INFO - .........Training Over!.............
使用[0,18,30]进行吞吐量测试：
2024-04-02 19:52:56,272 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:52:56,306 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    2/   20], loss: 0.000, per_step_time: 156859ms, lr: 1e-04, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:52:56,343 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   10.0% |█████                                             | 0.01 samples/s/p  0:47:03 }
2024-04-02 19:52:57,211 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:52:57,268 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    4/   20], loss: 0.000, per_step_time: 383ms, lr: 9.0999994e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:52:57,311 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   20.0% |██████████                                        | 5.22 samples/s/p  0:00:06 }
2024-04-02 19:52:58,073 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:52:58,130 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    6/   20], loss: 0.000, per_step_time: 332ms, lr: 8.2e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:52:58,151 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   30.0% |███████████████                                   | 6.02 samples/s/p  0:00:04 }
2024-04-02 19:52:58,864 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:52:58,910 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[    8/   20], loss: 0.000, per_step_time: 329ms, lr: 7.3e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:52:58,970 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   40.0% |████████████████████                              | 6.08 samples/s/p  0:00:03 }
2024-04-02 19:52:59,649 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:52:59,700 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   10/   20], loss: 0.000, per_step_time: 311ms, lr: 6.4e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:52:59,739 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   50.0% |█████████████████████████                         | 6.43 samples/s/p  0:00:03 }
2024-04-02 19:53:01,112 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:53:01,153 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   12/   20], loss: 0.000, per_step_time: 326ms, lr: 5.4999993e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:53:01,160 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   60.0% |██████████████████████████████                    | 6.14 samples/s/p  0:00:04 }
2024-04-02 19:53:02,080 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:53:02,086 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   14/   20], loss: 0.000, per_step_time: 429ms, lr: 4.5999997e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:53:02,105 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   70.0% |███████████████████████████████████               | 4.65 samples/s/p  0:00:02 }
2024-04-02 19:53:02,789 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:53:02,790 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   16/   20], loss: 0.000, per_step_time: 315ms, lr: 3.6999998e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:53:02,790 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   80.0% |████████████████████████████████████████          | 6.35 samples/s/p  0:00:01 }
2024-04-02 19:53:03,323 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:53:03,323 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   18/   20], loss: 0.000, per_step_time: 263ms, lr: 2.7999997e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:53:03,324 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   90.0% |█████████████████████████████████████████████     | 7.59 samples/s/p  0:00:00 }
2024-04-02 19:53:03,861 - mindformers[mindformers/core/callback/callback.py:249] - WARNING - pipeline stages: 2 > 1, the loss on the last card is valid.
2024-04-02 19:53:03,862 - mindformers[mindformers/core/callback/callback.py:315] - INFO - { Epoch:[  1/  1], step:[   20/   20], loss: 0.000, per_step_time: 265ms, lr: 1.8999996e-05, overflow cond: False, loss_scale: 4294967300.0
2024-04-02 19:53:03,862 - mindformers[mindformers/core/callback/callback.py:323] - INFO -   100.0% |██████████████████████████████████████████████████| 7.53 samples/s/p  0:00:00 }
2024-04-02 19:53:03,869 - mindformers[mindformers/trainer/base_trainer.py:735] - INFO - .........Training Over!.............
